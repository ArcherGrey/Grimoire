(window.webpackJsonp=window.webpackJsonp||[]).push([[229],{628:function(s,t,a){"use strict";a.r(t);var e=a(19),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"修改-create-react-app-的-webpack-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改-create-react-app-的-webpack-配置"}},[s._v("#")]),s._v(" 修改 "),a("code",[s._v("create react app")]),s._v(" 的 "),a("code",[s._v("webpack")]),s._v(" 配置")]),s._v(" "),a("h2",{attrs:{id:"eject"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#eject"}},[s._v("#")]),s._v(" "),a("code",[s._v("eject")])]),s._v(" "),a("p",[s._v("使用 "),a("code",[s._v("CRA")]),s._v(" 创建完项目以后，项目在 "),a("code",[s._v("package.json")]),s._v(" 里面提供了这样一个命令：")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"eject"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"react-scripts eject"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("执行完这个命令后会将封装在 "),a("code",[s._v("CRA")]),s._v(" 中的配置全部反编译到当前项目，这样用户就可以完全取得 "),a("code",[s._v("webpack")]),s._v(" 文件的控制权，想怎么修改就怎么修改了:")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# eject 后项目根目录下会出现 config 文件夹，里面就包含了 webpack 配置")]),s._v("\nconfig\n├── env.js\n├── jest\n│   ├── cssTransform.js\n│   └── fileTransform.js\n├── paths.js\n├── polyfills.js\n├── webpack.config.dev.js // 开发环境配置\n├── webpack.config.prod.js // 生产环境配置\n└── webpackDevServer.config.js\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("但如果使用了 "),a("code",[s._v("eject")]),s._v(" 命令，就再也享受不到 "),a("code",[s._v("CRA")]),s._v(" 升级带来的好处了，因为 "),a("code",[s._v("react-scripts")]),s._v(" 已经是以文件的形式存在于你的项目，而不是以包的形式，所以无法对其升级。")]),s._v(" "),a("h2",{attrs:{id:"替换-react-scripts-包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#替换-react-scripts-包"}},[s._v("#")]),s._v(" 替换 "),a("code",[s._v("react-scripts")]),s._v(" 包")]),s._v(" "),a("p",[a("code",[s._v("react-scripts")]),s._v(" 是 "),a("code",[s._v("CRA")]),s._v(" 的一个核心包，一些脚本和工具的默认配置都集成在里面，使用 "),a("code",[s._v("CRA")]),s._v(" 创建项目默认就是使用这个包，但是 "),a("code",[s._v("CRA")]),s._v(" 还提供了另外一种方式来创建 "),a("code",[s._v("CRA")]),s._v(" 项目，即使用自定义 "),a("code",[s._v("scripts")]),s._v(" 包的方式:")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认方式")]),s._v("\n$ create-react-app foo\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 自定义 scripts 包方式")]),s._v("\n$ create-react-app foo --scripts-version 自定义包\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("自定义包可以是下面几种形式：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("react-scripts")]),s._v(" 包的版本号，比如 "),a("code",[s._v("0.8.2")]),s._v("，这种形式可以用来安装低版本的 "),a("code",[s._v("react-scripts")]),s._v(" 包。")]),s._v(" "),a("li",[s._v("一个已经发布到 "),a("code",[s._v("npm")]),s._v(" 仓库上的包的名字，比如 "),a("code",[s._v("your-scripts")]),s._v("，里面包含了修改过的 "),a("code",[s._v("webpack")]),s._v(" 配置。")]),s._v(" "),a("li",[s._v("一个 "),a("code",[s._v("tgz")]),s._v(" 格式的压缩文件，比如 "),a("code",[s._v("/your/local/scripts.tgz")]),s._v("，通常是未发布到 "),a("code",[s._v("npm")]),s._v(" 仓库的自定义 "),a("code",[s._v("scripts")]),s._v(" 包，可以用 "),a("code",[s._v("npm pack")]),s._v(" 命令生成。")])]),s._v(" "),a("p",[s._v("这种方式相对于之前的 "),a("code",[s._v("eject")]),s._v(" 是一种更灵活地修改 "),a("code",[s._v("webpack")]),s._v(" 配置的方式，而且可以做到和 "),a("code",[s._v("CRA")]),s._v(" 一样，通过升级 "),a("code",[s._v("scrips")]),s._v(" 包来升级项目特性。\n自定义 "),a("code",[s._v("scripts")]),s._v(" 包的结构可以参照 "),a("code",[s._v("react-scripts")]),s._v(" 包的结构，只要修改对应的 "),a("code",[s._v("webpack")]),s._v(" 配置文件，并安装上所需的 "),a("code",[s._v("webpack loader")]),s._v(" 或 "),a("code",[s._v("plugin")]),s._v(" 包就可以了。")]),s._v(" "),a("h2",{attrs:{id:"customize-cra"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#customize-cra"}},[s._v("#")]),s._v(" "),a("code",[s._v("customize-cra")])]),s._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/arackaf/customize-cra",target:"_blank",rel:"noopener noreferrer"}},[s._v("地址"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("根据文档扩展配置：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" override "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"customize-cra"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("修改 "),a("code",[s._v("package.json")]),s._v(":")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"start"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"react-app-rewired start"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"build"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"react-app-rewired build"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"test"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"react-app-rewired test --env=jsdom"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"eject"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"react-scripts eject"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h2",{attrs:{id:"craco"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#craco"}},[s._v("#")]),s._v(" "),a("code",[s._v("CRACO")])]),s._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/gsoft-inc/craco",target:"_blank",rel:"noopener noreferrer"}},[s._v("地址"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("无需 "),a("code",[s._v("eject")]),s._v("，通过 "),a("code",[s._v("craco.config")]),s._v(" 就能自定义配置")]),s._v(" "),a("ol",[a("li",[s._v("安装：")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" @craco/craco\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# OR")]),s._v("\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" @craco/craco --save\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("根目录下创建 "),a("code",[s._v("craco.config.js")])]),s._v(" "),a("li",[s._v("修改 "),a("code",[s._v("package.json")]),s._v(" 里面的 "),a("code",[s._v("script")]),s._v(":")])]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* package.json */")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n-   "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"start"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"react-scripts start"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n+   "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"start"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"craco start"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n-   "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"build"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"react-scripts build"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n+   "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"build"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"craco build"')]),s._v("\n-   "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"test"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"react-scripts test"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n+   "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"test"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"craco test"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h2",{attrs:{id:"比较"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#比较"}},[s._v("#")]),s._v(" 比较")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("eject")]),s._v(" 不可逆，而且无法随着官方升级")]),s._v(" "),a("li",[a("code",[s._v("react-script")]),s._v(" 需自己发布维护自定义包，适合长期维护的项目")]),s._v(" "),a("li",[a("code",[s._v("custom-cra")]),s._v(" 2020 5 月就没更新了，配置较复杂，许多 "),a("code",[s._v("plugin loader")]),s._v(" 无法配置")]),s._v(" "),a("li",[a("code",[s._v("craco")]),s._v(" 还在维护 感觉功能也比 "),a("code",[s._v("custom-cra")]),s._v(" 强，"),a("code",[s._v("antd")]),s._v(" 推荐使用")])])])}),[],!1,null,null,null);t.default=r.exports}}]);