(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{462:function(a,s,e){"use strict";e.r(s);var t=e(19),n=Object(t.a)({},(function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"webpack-打包优化"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#webpack-打包优化"}},[a._v("#")]),a._v(" webpack 打包优化")]),a._v(" "),e("h2",{attrs:{id:"分析工具"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#分析工具"}},[a._v("#")]),a._v(" 分析工具")]),a._v(" "),e("h3",{attrs:{id:"体积分析"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#体积分析"}},[a._v("#")]),a._v(" 体积分析")]),a._v(" "),e("h4",{attrs:{id:"官方工具"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#官方工具"}},[a._v("#")]),a._v(" 官方工具")]),a._v(" "),e("p",[a._v("可以通过官方提供的 "),e("code",[a._v("stat.json")]),a._v(" 文件帮助我们分析打包结果，"),e("code",[a._v("stat.json")]),a._v(" 文件可以通过下面语句快速生成：")]),a._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("webpack --profile --json "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" stats.json\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("上传到 "),e("a",{attrs:{href:"http://webpack.github.io/analyse/",target:"_blank",rel:"noopener noreferrer"}},[a._v("分析工具"),e("OutboundLink")],1),a._v("，得到下面的分析结果：")]),a._v(" "),e("img",{attrs:{src:a.$withBase("/eng_wpbuild_1.png"),alt:"分析结果"}}),a._v(" "),e("p",[a._v("只适用于直接使用 "),e("code",[a._v("webpack.config")]),a._v(" 的项目，使用脚手架的项目不能得到正确结果（"),e("code",[a._v("create-react-app")]),a._v("）")]),a._v(" "),e("h4",{attrs:{id:"第三方工具"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#第三方工具"}},[a._v("#")]),a._v(" 第三方工具")]),a._v(" "),e("p",[e("code",[a._v("webpack-bundle-analyzer")]),a._v(" 也是基于 "),e("code",[a._v("stat.json")]),a._v(" 文件进行分析，可以可视化展示出来")]),a._v(" "),e("p",[a._v("使用方式：")]),a._v(" "),e("ul",[e("li",[a._v("插件：加入到配置文件中")])]),a._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("const")]),a._v(" BundleAnalyzerPlugin "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"webpack-bundle-analyzer"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("BundleAnalyzerPlugin"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\nmodule"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("exports "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  plugins"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("BundleAnalyzerPlugin")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br")])]),e("ul",[e("li",[a._v("工具：全局安装，按照上面方法先生成 "),e("code",[a._v("stat.json")]),a._v("，然后运行下面命令：")])]),a._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("webpack-bundle-analyzer bundle/output/path/stats.json\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[e("code",[a._v("create-react-app")]),a._v(" 可以使用 "),e("code",[a._v("custom-cra")]),a._v(" 里面的 "),e("code",[a._v("addBundleVisualizer")]),a._v(" 来配置，需要开发依赖安装 "),e("code",[a._v("webpack-bundle-analyzer")])]),a._v(" "),e("p",[e("strong",[a._v("build 命令得到结果来分析")])]),a._v(" "),e("h3",{attrs:{id:"速度分析"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#速度分析"}},[a._v("#")]),a._v(" 速度分析")]),a._v(" "),e("p",[e("code",[a._v("speed-measure-webpack-plugin")])]),a._v(" "),e("h2",{attrs:{id:"策略"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#策略"}},[a._v("#")]),a._v(" 策略")]),a._v(" "),e("ul",[e("li",[a._v("使用新版本")]),a._v(" "),e("li",[a._v("体积优化\n"),e("ul",[e("li",[a._v("js css 压缩")]),a._v(" "),e("li",[a._v("刪除无用的 css\n"),e("ul",[e("li",[e("code",[a._v("PurgeCSS mini-css-extract-plugin")])])])]),a._v(" "),e("li",[a._v("图片压缩\n"),e("ul",[e("li",[a._v("手动压缩图片 "),e("a",{attrs:{href:"https://tinypng.com/",target:"_blank",rel:"noopener noreferrer"}},[a._v("tiny png"),e("OutboundLink")],1)]),a._v(" "),e("li",[a._v("自动 "),e("code",[a._v("image-webpack-loader")])])])]),a._v(" "),e("li",[a._v("拆分代码")])])]),a._v(" "),e("li",[a._v("速度优化\n"),e("ul",[e("li",[a._v("分离开发、生成环境配置")]),a._v(" "),e("li",[a._v("减少查找过程：对 "),e("code",[a._v("resolve")]),a._v(" 参数进行合理配置，使用 "),e("code",[a._v("resolve")]),a._v(" 字段告诉 "),e("code",[a._v("webpack")]),a._v(" 怎么去搜索文件")]),a._v(" "),e("li",[a._v("优化 "),e("code",[a._v("resolve.modules")])]),a._v(" "),e("li",[a._v("使用 "),e("code",[a._v("resolve.alias")]),a._v(" 减少查找过程")]),a._v(" "),e("li",[a._v("多线程 "),e("code",[a._v("thread-loader")])]),a._v(" "),e("li",[a._v("预先编译资源模块 "),e("code",[a._v("webpack.DllPlugin")])]),a._v(" "),e("li",[a._v("缓存 "),e("code",[a._v("Cache")]),a._v(" 相关")]),a._v(" "),e("li",[a._v("合理使用 "),e("code",[a._v("sourceMap")])])])])])])}),[],!1,null,null,null);s.default=n.exports}}]);